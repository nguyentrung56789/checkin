:root{ --bar-h:76px }
html,body{
  height:100%;margin:0;min-height:-webkit-fill-available;background:#000;color:#fff;
  font-family:system-ui,Segoe UI,Roboto,Arial;overflow:hidden
}
.stage{
  position:fixed;inset:0 0 var(--bar-h) 0;display:flex;align-items:center;justify-content:center;
  background:#000;z-index:1;height:calc(100vh - var(--bar-h))
}
@supports (height:100dvh){.stage{height:calc(100dvh - var(--bar-h))}}
video,canvas{
  width:100%;height:100%;object-fit:contain;display:block;pointer-events:none;background:#000;
  transition:transform .15s ease
}
.bar{
  position:fixed;left:0;right:0;bottom:0;height:var(--bar-h);
  background:rgba(0,0,0,0.25);backdrop-filter:blur(10px);
  border-top:1px solid rgba(255,255,255,.1);
  display:flex;gap:10px;align-items:center;justify-content:center;
  padding:10px calc(12px + env(safe-area-inset-right))
           calc(10px + env(safe-area-inset-bottom))
           calc(12px + env(safe-area-inset-left));
  z-index:50;
}
.btn{appearance:none;border:none;border-radius:10px;padding:8px 12px;font-weight:600;font-size:14px;cursor:pointer;white-space:nowrap}
.btn-blue{background:#2563eb;color:#fff}
.btn-green{background:#10b981;color:#fff}
.btn-gray{background:#374151;color:#fff}
.btn-on{background:#10b981!important;color:#fff!important}
.btn-icon{padding:8px;width:40px;text-align:center;font-size:18px}

#toast{
  position:fixed;left:50%;top:0;transform:translate(-50%,-120%);
  opacity:0;background:#e0f2fe;color:#075985;border:1px solid #38bdf8;
  padding:10px 14px;border-radius:12px;font-weight:700;
  transition:transform .25s ease,opacity .25s ease;z-index:99;
  box-shadow:0 6px 22px rgba(0,0,0,.25);
}

#mapSheet{
  position:fixed;left:0;right:0;bottom:0;top:0;background:#000;
  border-top:2px solid #1e3a8a;transform:translateY(100%);
  transition:transform .35s ease;z-index:90;display:flex;flex-direction:column;
}
#mapSheet.open{transform:translateY(0)}
#mapHeader{background:#1e3a8a;color:#fff;padding:12px 16px;text-align:center;font-weight:700;cursor:pointer;user-select:none}
#mapHeader .grab{display:inline-block;width:42px;height:5px;border-radius:3px;background:#ffffff55;margin:0 10px 2px 0;vertical-align:middle}
#mapFrame{flex:1;border:none;display:block;width:100%}

#tagInfo{
  position:fixed;left:12px;top:10px;z-index:60;background:#111a;border:1px solid #ffffff22;
  border-radius:10px;padding:6px 10px;font-size:12px;backdrop-filter:blur(6px)
}
